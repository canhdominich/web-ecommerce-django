{% extends "app/base.html" %}
{%load static%}

<!--data-bs-ride="carousel" : tự đọng chuyển
class="col-lg-3": dàn 4 sản phẩm trên 1 hàng
class="col-lg-4": dàn 3 sản phẩm trên 1 hàng-->

{% block banner_slider %}
<div id="carouselExampleDark" class="carousel carousel-dark slide" data-bs-ride="carousel">
    <div class="carousel-indicators">
      <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
      <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="1" aria-label="Slide 2"></button>
      <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="2" aria-label="Slide 3"></button>
      <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="3" aria-label="Slide 4"></button>
    </div>
    <div class="carousel-inner">
      <div class="carousel-item active" data-bs-interval="5000">
        <img src="https://cdn.tgdd.vn/News/Thumb/1465203/sua-co-gai-ha-lan-dutch-lady-co-tang-can-khong-me-thumb-1200x628.jpg" class="d-block w-100" alt="Cô gái Hà Lan" height="380">
        <div class="carousel-caption d-none d-md-block bg-success text-white p-2">
          <h5>Sữa mới </h5>
          <p>Cô gái Hà Lan xinh tươi</p>
        </div>
      </div>
      <div class="carousel-item" data-bs-interval="2000">
        <img src="https://cdn.tgdd.vn/News/Thumb/1465203/sua-co-gai-ha-lan-dutch-lady-co-tang-can-khong-me-thumb-1200x628.jpg" class="d-block w-100" alt="Sữa bột" height="380">
        <div class="carousel-caption d-none d-md-block bg-success text-white p-2">
          <h5>Sữa mới</h5>
          <p>Mẹ và bé</p>
        </div>
      </div>
      <div class="carousel-item">
        <img src="https://cdn.tgdd.vn/News/Thumb/1465203/sua-co-gai-ha-lan-dutch-lady-co-tang-can-khong-me-thumb-1200x628.jpg" class="d-block w-100" alt="Sữa đặc" height="380">
        <div class="carousel-caption d-none d-md-block">
          <h5>Sữa mới</h5>
          <p>Không loãng</p>
        </div>
      </div>
      <div class="carousel-item">
        <img src="https://cdn.tgdd.vn/News/Thumb/1465203/sua-co-gai-ha-lan-dutch-lady-co-tang-can-khong-me-thumb-1200x628.jpg" class="d-block w-100" alt="Sữa không đường" height="380">
        <div class="carousel-caption d-none d-md-block ">
          <h5>Sữa mới</h5>
          <p>Không có đường</p>
        </div>
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
{% endblock banner_slider %}

{% block main-content %}
<div class="container my-5">
  <div class="text-center mb-5 fade-in">
    <h2 class="display-4 fw-bold mb-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
      Sản phẩm nổi bật
    </h2>
    <p class="text-muted">Khám phá những sản phẩm tốt nhất của chúng tôi</p>
  </div>
  
  <div class="row g-4">
    {% for product in products %}
    <div class="col-lg-3 col-md-4 col-sm-6">
        <div class="card h-100 shadow-sm">
            <div class="position-relative overflow-hidden">
                {% if product.product_image %}
                <img class="card-img-top" src="{{product.product_image.url}}" alt="{{product.title}}" style="height: 250px; object-fit: cover;">
                {% else %}
                <div class="card-img-top img-placeholder" style="height: 250px;">Không có ảnh</div>
                {% endif %}
                {% if product.selling_price > product.discounted_price %}
                <span class="badge bg-danger position-absolute top-0 end-0 m-2">
                  -{{product.selling_price|add:product.discounted_price|floatformat:0|add:"-"|slice:":2"}}%
                </span>
                {% endif %}
            </div>
            <div class="card-body d-flex flex-column">
              <h6 class="card-title fw-bold mb-2">{{product.title}}</h6>
              <div class="mt-auto">
                  <div class="mb-3">
                    <span class="price-tag">{{product.discounted_price|floatformat:0}}₫</span>
                    {% if product.selling_price > product.discounted_price %}
                    <span class="price-old">{{product.selling_price|floatformat:0}}₫</span>
                    {% endif %}
                  </div>
                  <div class="d-grid gap-2">
                      {% if user.is_authenticated %}
                      <button data-product={{product.id}} data-action="add" class="btn btn-primary update-cart">
                        <i class="fas fa-cart-plus me-2"></i>Thêm vào giỏ
                      </button>
                      {% endif %}
                      <a class="btn btn-outline-success" href="{% url 'product_detail' product.id %}">
                        <i class="fas fa-eye me-2"></i>Xem chi tiết
                      </a>
                  </div>
              </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12">
      <div class="empty-state">
        <i class="fas fa-box-open"></i>
        <h4>Chưa có sản phẩm nào</h4>
        <p class="text-muted">Sản phẩm sẽ được cập nhật sớm nhất</p>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock main-content %}